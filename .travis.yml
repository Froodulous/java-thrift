sudo: required
dist: trusty

language: java
jdk:
- oraclejdk8

cache:
  directories:
  - $HOME/.m2/repository

before_install:
  # install Apache Thrift
  - sudo apt-get update -qq
  - sudo apt-get install libboost-dev libboost-test-dev libboost-program-options-dev libevent-dev automake libtool flex bison pkg-config g++ libssl-dev
  - wget http://archive.apache.org/dist/thrift/0.10.0/thrift-0.10.0.tar.gz
  - tar xfz thrift-0.10.0.tar.gz
  - cd thrift-0.10.0
  - ./configure --without-c_glib --without-cpp --without-ruby --without-python --without-go --without-erlang --without-nodejs --without-php
  - sudo make install
  - cd ..

  # allocate commits to CI, not the owner of the deploy key
  - git config user.name "opentracingci"
  - git config user.email "opentracingci+opentracing@googlegroups.com"

  # setup https authentication credentials, used by ./mvnw release:prepare
  - git config credential.helper "store --file=.git/credentials"
  - echo "https://$GH_TOKEN:@github.com" > .git/credentials

install:
  # Override default travis to use the maven wrapper
  - ./mvnw install -DskipTests=true -Dmaven.javadoc.skip=true -B -V

script:
  - ./travis/publish.sh

branches:
  except:
    - /^[0-9]/

env:
  global:
  # Ex. travis encrypt BINTRAY_USER=your_github_account
  - secure: ""
  # Ex. travis encrypt BINTRAY_KEY=xxx-https://bintray.com/profile/edit-xxx --add
  - secure: ""
  # Ex. travis encrypt GH_TOKEN=XXX-https://github.com/settings/tokens-XXX --add
  - secure: ""
  # Ex. travis encrypt SONATYPE_USER=your_sonatype_account
  - secure: ""
  # Ex. travis encrypt SONATYPE_PASSWORD=your_sonatype_password
  - secure: ""
